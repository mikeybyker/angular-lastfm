{"version":3,"sources":["angular.lastfm.js"],"names":["LastFM","endPoint","config","api_key","format","this","setAPIKey","key","getAPIKey","setFormat","getFormat","setEndPoint","url","getEndPoint","$get","$q","$http","LastFMService","version","http","settings","options","params","getParams","get","angular","extend","getSettings","fieldName","isMbid","mbid","str","mbidPattern","test","_getAlbumInfo","artistOrMbid","album","artist","method","getAlbumInfo","apply","_p","arguments","then","response","data","error","reject","_searchAlbum","searchAlbum","results","albummatches","_getAlbumTopTags","getAlbumTopTags","toptags","tag","_getTopAlbums","getTopAlbums","topalbums","_getArtistInfo","getArtistInfo","_searchArtists","searchArtists","artistmatches","_getSimilar","getSimilar","similarartists","_getArtistTopTags","getArtistTopTags","_getTopTracks","getTopTracks","toptracks","track","_getTopArtists","getTopArtists","artists","_getChartsTopTags","getChartsTopTags","tags","_getChartsTopTracks","getChartsTopTracks","tracks","_getTopGeoArtists","country","getTopGeoArtists","topartists","_getTopGeoTracks","getTopGeoTracks","_searchTrack","searchTrack","prototype","trackmatches","_getSimilarTrack","getSimilarTrack","similartracks","_getTrackTopTags","getTrackTopTags","_getTrackInfo","getTrackInfo","reason","statusText","message","Album","search","topTags","_album","_search","_topTags","Artist","albums","similar","_albums","_artist","_similar","_tracks","Charts","topArtists","topTracks","_topArtists","_topTracks","Geo","Track","_track","module","provider"],"mappings":"CAAC,WACG,YAMA,SAASA,KAEL,GAAIC,GAAW,oCACXC,GAAUC,QAAS,KAAMC,OAAQ,OAErCC,MAAKC,UAAY,SAAUC,GAEvB,MADAL,GAAOC,QAAUI,EACVL,EAAOC,SAElBE,KAAKG,UAAY,WACb,MAAON,GAAOC,SAElBE,KAAKI,UAAY,SAAUL,GAEvB,MADAF,GAAOE,OAASA,EACTF,EAAOE,QAElBC,KAAKK,UAAY,WACb,MAAOR,GAAOE,QAElBC,KAAKM,YAAc,SAAUC,GAEzB,MADAX,GAAWW,GAGfP,KAAKQ,YAAc,WACf,MAAOZ,IAGXI,KAAKS,MAAA,KAAA,QAAO,SAASC,EAAIC,GAKrB,QAASC,KAEL,GADAZ,KAAKa,QAAU,SACXhB,EAAOC,QACP,KAAA,sEAIR,QAASgB,GAAKC,EAAUC,GACpB,GAAIC,GAASC,EAAUH,EAAUC,EACjC,OAAOL,GAAMQ,IAAIvB,GAAWqB,OAAQA,IAGxC,QAASC,GAAUH,EAAUC,GACzB,MAAQI,SAAQC,UAEJxB,EACAkB,EACAC,OAIhB,QAASM,GAAYP,EAAUQ,GAQ3B,MAPAA,GAAYA,GAAa,SACtBC,EAAOT,EAASQ,MACfR,EAASU,KAAOV,EAASQ,GACzBR,EAASQ,GAAa,IAInBR,EAGX,QAASS,GAAOE,GACZ,MAAOC,GAAYC,KAAKF,GAI5B,QAASG,GAAcC,EAAcC,EAAOf,GACxC,GAAID,IACQiB,OAAQF,EACRC,MAAOA,EACPE,OAAQ,gBAKpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAASkB,GAAaJ,EAAcC,EAAOf,GACvC,MAAOa,GAAcM,MAAMC,EAAIC,WACtBC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKT,MAC9BW,EAAOH,EAAU,4BAErBA,EAASC,KAAKT,QAKrC,QAASY,GAAaZ,EAAOf,GACzB,GAAID,IACQgB,MAAOA,EACPE,OAAQ,eAIpB,OAAOnB,GAAKC,EAAUC,GAG1B,QAAS4B,GAAYb,EAAOf,GACxB,MAAO2B,GAAaR,MAAMC,EAAIC,WACzBC,KAAK,SAASC,GACX,OAAGA,EAASC,KAAKC,OAAUF,EAASC,KAAKK,SAAYN,EAASC,KAAKK,QAAQC,aAGpEP,EAASC,KAAKK,QAAQC,aAAaf,MAF/BW,EAAOH,EAAU,8BAWxC,QAASQ,GAAiBjB,EAAcC,EAAOf,GAC3C,GAAID,IACQkB,OAAQ,mBACRF,MAAOA,EACPC,OAAQF,EAKpB,OADAf,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAG1B,QAASgC,GAAgBlB,EAAcC,EAAOf,GAC1C,MAAO+B,GAAiBZ,MAAMC,EAAIC,WAC7BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKS,QAC9BP,EAAOH,EAAU,yBAErBA,EAASC,KAAKS,QAAQC,MAQzC,QAASC,GAAcrB,EAAcd,GACjC,GAAID,IACQiB,OAAQF,EACRG,OAAQ,sBAOpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAASoC,GAAatB,EAAcd,GAChC,MAAOmC,GAAchB,MAAMC,EAAIC,WAC1BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKa,UAC9BX,EAAOH,EAAU,wBAErBA,EAASC,KAAKa,UAAUtB,QAK3C,QAASuB,GAAexB,EAAcd,GAClC,GAAID,IACQiB,OAAQF,EACRG,OAAQ,iBAMpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAASuC,GAAczB,EAAcd,GACjC,MAAOsC,GAAenB,MAAMC,EAAIC,WAC3BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKR,OAC9BU,EAAOH,EAAU,wBAErBA,EAASC,KAAKR,SAKjC,QAASwB,GAAexB,EAAQhB,GAC5B,GAAID,IACQiB,OAAQA,EACRC,OAAQ,gBAIpB,OAAOnB,GAAKC,EAAUC,GAE1B,QAASyC,GAAczB,EAAQhB,GAC3B,MAAOwC,GAAerB,MAAMC,EAAIC,WAC3BC,KAAK,SAASC,GACX,OAAGA,EAASC,KAAKC,OAAUF,EAASC,KAAKK,SAAYN,EAASC,KAAKK,QAAQa,cAGpEnB,EAASC,KAAKK,QAAQa,cAAc1B,OAFhCU,EAAOH,EAAU,0BAOxC,QAASoB,GAAY7B,EAAcd,GAC/B,GAAID,IACQiB,OAAQF,EACRG,OAAQ,oBAMpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAAS4C,GAAW9B,EAAcd,GAC9B,MAAO2C,GAAYxB,MAAMC,EAAIC,WACxBC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKqB,eAC9BnB,EAAOH,EAAU,iCAErBA,EAASC,KAAKqB,eAAe7B,SAMhD,QAAS8B,GAAkBhC,EAAcd,GACrC,GAAID,IACQiB,OAAQF,EACRG,OAAQ,oBAKpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAAS+C,GAAiBjC,EAAcd,GACpC,MAAO8C,GAAkB3B,MAAMC,EAAIC,WAC9BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKS,QAC9BP,EAAOH,EAAU,sBAErBA,EAASC,KAAKS,QAAQC,MAMzC,QAASc,GAAclC,EAAcd,GACjC,GAAID,IACQiB,OAAQF,EACRG,OAAQ,sBAOpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAASiD,GAAanC,EAAcd,GAChC,MAAOgD,GAAc7B,MAAMC,EAAIC,WAC1BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAK0B,UAC9BxB,EAAOH,EAAU,wBAErBA,EAASC,KAAK0B,UAAUC,QAQ3C,QAASC,GAAepD,GACpB,GAAID,IACQkB,OAAQ,sBAIpB,OAAOnB,GAAKC,EAAUC,GAE1B,QAASqD,GAAcrD,GACnB,MAAOoD,GAAejC,MAAMC,EAAIC,WAC3BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAK8B,QAC9B5B,EAAOH,EAAU,wBAErBA,EAASC,KAAK8B,QAAQtC,SAKzC,QAASuC,GAAkBvD,GACvB,GAAID,IACQkB,OAAQ,mBAIpB,OAAOnB,GAAKC,EAAUC,GAE1B,QAASwD,GAAiBxD,GACtB,MAAOuD,GAAkBpC,MAAMC,EAAIC,WAC9BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKiC,KAC9B/B,EAAOH,EAAU,sBAErBA,EAASC,KAAKiC,KAAKvB,MAKtC,QAASwB,GAAoB1D,GACzB,GAAID,IACQkB,OAAQ,qBAIpB,OAAOnB,GAAKC,EAAUC,GAE1B,QAAS2D,GAAmB3D,GACxB,MAAO0D,GAAoBvC,MAAMC,EAAIC,WAChCC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKoC,OAC9BlC,EAAOH,EAAU,wBAErBA,EAASC,KAAKoC,OAAOT,QAQxC,QAASU,GAAkBC,EAAS9D,GAChC,GAAID,IACQ+D,QAASA,EACT7C,OAAQ,oBAIpB,OAAOnB,GAAKC,EAAUC,GAE1B,QAAS+D,GAAiBD,EAAS9D,GAC/B,MAAO6D,GAAkB1C,MAAMC,EAAIC,WAC9BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKwC,WAC9BtC,EAAOH,EAAU,yBAErBA,EAASC,KAAKwC,WAAWhD,SAK5C,QAASiD,GAAiBH,EAAS9D,GAC/B,GAAID,IACQ+D,QAASA,EACT7C,OAAQ,mBAKpB,OAAOnB,GAAKC,EAAUC,GAE1B,QAASkE,GAAgBJ,EAAS9D,GAC9B,MAAOiE,GAAiB9C,MAAMC,EAAIC,WAC7BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKoC,OAC9BlC,EAAOH,EAAU,wBAErBA,EAASC,KAAKoC,OAAOT,QAQxC,QAASgB,GAAahB,EAAOnD,GACzB,GAAID,IACQoD,MAAOA,EACPlC,OAAQ,eAIpB,OAAOnB,GAAKC,EAAUC,GAE1B,QAASoE,GAAYjB,EAAOnD,GAExB,MAAOmE,GAAahD,MAAMvB,EAAcyE,UAAWhD,WAC9CC,KAAK,SAASC,GACX,OAAGA,EAASC,KAAKC,OAAUF,EAASC,KAAKK,SAAYN,EAASC,KAAKK,QAAQyC,aAGpE/C,EAASC,KAAKK,QAAQyC,aAAanB,MAF/BzB,EAAOH,EAAU,yBAOxC,QAASgD,GAAiBzD,EAAcqC,EAAOnD,GAC3C,GAAID,IACQiB,OAAQF,EACRqC,MAAOA,EACPlC,OAAQ,mBAMpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAASwE,GAAgB1D,EAAcqC,EAAOnD,GAC1C,MAAOuE,GAAiBpD,MAAMC,EAAIC,WAC7BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKiD,cAC9B/C,EAAOH,EAAU,gCAErBA,EAASC,KAAKiD,cAActB,QAK/C,QAASuB,GAAiB1D,EAAQmC,EAAOnD,GACrC,GAAID,IACQiB,OAAQA,EACRmC,MAAOA,EACPlC,OAAQ,mBAKpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAAS2E,GAAgB3D,EAAQmC,EAAOnD,GACpC,MAAO0E,GAAiBvD,MAAMC,EAAIC,WAC7BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAKS,QAC9BP,EAAOH,EAAU,sBAErBA,EAASC,KAAKS,QAAQC,MAKzC,QAAS0C,GAAc9D,EAAcqC,EAAOnD,GACxC,GAAID,IACQiB,OAAQF,EACRqC,MAAOA,EACPlC,OAAQ,gBAKpB,OADAlB,GAAWO,EAAYP,GAChBD,EAAKC,EAAUC,GAE1B,QAAS6E,GAAa/D,EAAcqC,EAAOnD,GACvC,MAAO4E,GAAczD,MAAMC,EAAIC,WAC1BC,KAAK,SAASC,GACX,MAAGA,GAASC,KAAKC,QAAUF,EAASC,KAAK2B,MAC9BzB,EAAOH,EAAU,uBAErBA,EAASC,KAAK2B,QAIjC,QAASzB,GAAOH,EAAUuD,GACtB,GAAIrD,IACIA,MAAOF,EAASC,KAAKC,QAAS,EAC9BsD,WAAYxD,EAASC,KAAKwD,SAAYF,GAAU,QAExD,OAAOpF,GAAGgC,OAAOD,GA5brB,GAAId,GAAc,sDA+blBf,GAAcyE,WACVnE,UAAoBA,EACpBM,OAAoBA,EACpByE,OACIlE,MAAgBG,EAChBgE,OAAgBtD,EAChBuD,QAAgBnD,EAChBoD,OAAgBvE,EAChBwE,QAAgB1D,EAChB2D,SAAgBvD,GAEpBwD,QACIC,OAAgBpD,EAChBpB,OAAgBuB,EAChB2C,OAAgBzC,EAChBgD,QAAgB7C,EAChBuC,QAAgBpC,EAChBa,OAAgBX,EAChByC,QAAgBvD,EAChBwD,QAAgBrD,EAChB+C,QAAgB7C,EAChBoD,SAAgBjD,EAChB2C,SAAgBxC,EAChB+C,QAAgB7C,GAEpB8C,QACIC,WAAgB1C,EAChB8B,QAAgB3B,EAChBwC,UAAgBrC,EAChBsC,YAAgB7C,EAChBkC,SAAgB/B,EAChB2C,WAAgBxC,GAGpByC,KACIJ,WAAgBhC,EAChBiC,UAAgB9B,EAChB+B,YAAgBpC,EAChBqC,WAAgBjC,GAGpBmC,OACIlB,OAAgBd,EAChBqB,QAAgBjB,EAChBW,QAAgBR,EAChBxB,MAAgB0B,EAChBQ,QAAgBlB,EAChByB,SAAgBrB,EAChBe,SAAgBZ,EAChB2B,OAAgBzB,GAKxB,IAAIxD,GAAKxB,EAAcyE,SAEvB,OAAO,IAAIzE,KAzhBnBQ,QACKkG,OAAO,aACPC,SAAS,SAAU5H","file":"angular.lastfm.min.js","sourcesContent":["(function(){\r\n    'use strict';\r\n\r\n    angular\r\n        .module('lastfm', [])\r\n        .provider('LastFM', LastFM);\r\n\r\n    function LastFM(){\r\n\r\n        var endPoint = 'http://ws.audioscrobbler.com/2.0/',\r\n            config = {api_key: null, format: 'json'};\r\n\r\n        this.setAPIKey = function (key) {\r\n            config.api_key = key;\r\n            return config.api_key;\r\n        };\r\n        this.getAPIKey = function () {\r\n            return config.api_key;\r\n        };\r\n        this.setFormat = function (format) {\r\n            config.format = format;\r\n            return config.format;\r\n        };\r\n        this.getFormat = function () {\r\n            return config.format;\r\n        };\r\n        this.setEndPoint = function (url) {\r\n            endPoint = url;\r\n            return endPoint;\r\n        };\r\n        this.getEndPoint = function () {\r\n            return endPoint;\r\n        };\r\n\r\n        this.$get = function($q, $http){\r\n\r\n            // Regex for matching Music Brainz Identifier (mbid)\r\n            var mbidPattern = /^[a-fA-F0-9]{8}(-[a-fA-F0-9]{4}){3}-[a-fA-F0-9]{12}$/;\r\n\r\n            function LastFMService() {\r\n                this.version = '1.0.0';\r\n                if(!config.api_key){\r\n                    throw ('LastFm API key NOT set : Use setAPIKey on the provider in config...');\r\n                }\r\n            }\r\n\r\n            function http(settings, options){\r\n                var params = getParams(settings, options);\r\n                return $http.get(endPoint, {params: params});\r\n            }\r\n\r\n            function getParams(settings, options){\r\n                return  angular.extend(\r\n                            {},             // So we don't pollute the objects\r\n                            config,         // api_key and format\r\n                            settings,       // method etc.\r\n                            options || {}   // user options\r\n                        );\r\n            }\r\n\r\n            function getSettings(settings, fieldName){\r\n                fieldName = fieldName || 'artist';\r\n                if(isMbid(settings[fieldName])){\r\n                    settings.mbid = settings[fieldName];\r\n                    settings[fieldName] = '';\r\n                    // or... mbid takes precedence, regardless\r\n                    // delete settings[fieldName];\r\n                }\r\n                return settings;\r\n            }\r\n\r\n            function isMbid(str){\r\n                return mbidPattern.test(str);\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/album.getInfo\r\n            function _getAlbumInfo(artistOrMbid, album, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            album: album,\r\n                            method: 'album.getinfo'                            // mbid: mbid,\r\n                            // autocorrect: 1,\r\n                            // lang: 'de'\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getAlbumInfo(artistOrMbid, album, options){\r\n                return _getAlbumInfo.apply(_p, arguments)\r\n                        .then(function(response){\r\n                            if(response.data.error || !response.data.album){\r\n                                return reject(response, 'Couldn\\'t find this album');\r\n                            }\r\n                            return response.data.album;\r\n                        });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/album.search\r\n            function _searchAlbum(album, options){\r\n                var settings = {\r\n                            album: album,\r\n                            method: 'album.search'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            // Return the actual albums found, rather than end user digging the data for them...\r\n            function searchAlbum(album, options){\r\n                return _searchAlbum.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.results || !response.data.results.albummatches){\r\n                            return reject(response, 'Couldn\\'t find this album');\r\n                        }\r\n                        return response.data.results.albummatches.album;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/album.getTopTags\r\n            /*\r\n                Note: Docs say artist & album optional if mbid is used...\r\n                That appers wrong - supplying mbid returns error artist/album missing.\r\n            */\r\n            function _getAlbumTopTags(artistOrMbid, album, options){\r\n                var settings = {\r\n                            method: 'album.gettoptags',\r\n                            album :album,\r\n                            artist :artistOrMbid\r\n                            // mbid :mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            //\r\n            function getAlbumTopTags(artistOrMbid, album, options){\r\n                return _getAlbumTopTags.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptags){\r\n                            return reject(response, 'Error looking up tags');\r\n                        }\r\n                        return response.data.toptags.tag;\r\n                    });\r\n            }\r\n\r\n\r\n            // Artist\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getTopAlbums\r\n            function _getTopAlbums(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.gettopalbums'\r\n                            // mbid: mbid,\r\n                            // limit: 10,\r\n                            // autocorrect: 1,\r\n                            // page: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTopAlbums(artistOrMbid, options){\r\n                return _getTopAlbums.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.topalbums){\r\n                            return reject(response, 'Couldn\\'t find albums');\r\n                        }\r\n                        return response.data.topalbums.album;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getInfo\r\n            function _getArtistInfo(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.getinfo'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1,\r\n                            // lang: 'de'\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getArtistInfo(artistOrMbid, options){\r\n                return _getArtistInfo.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.artist){\r\n                            return reject(response, 'Couldn\\'t find artist');\r\n                        }\r\n                        return response.data.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.search\r\n            function _searchArtists(artist, options) {\r\n                var settings = {\r\n                            artist: artist,\r\n                            method: 'artist.search'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function searchArtists(artist, options) {\r\n                return _searchArtists.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.results || !response.data.results.artistmatches){\r\n                            return reject(response, 'Couldn\\'t find artist');\r\n                        }\r\n                        return response.data.results.artistmatches.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getSimilar\r\n            function _getSimilar(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.getsimilar'\r\n                            // mbid: mbid,\r\n                            // limit: 10,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getSimilar(artistOrMbid, options){\r\n                return _getSimilar.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.similarartists){\r\n                            return reject(response, 'Couldn\\'t find similar artists');\r\n                        }\r\n                        return response.data.similarartists.artist;\r\n                    });\r\n            }\r\n\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getTopTags\r\n            function _getArtistTopTags(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.gettoptags'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getArtistTopTags(artistOrMbid, options){\r\n                return _getArtistTopTags.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptags){\r\n                            return reject(response, 'Couldn\\'t find tags');\r\n                        }\r\n                        return response.data.toptags.tag;\r\n                    });\r\n            }\r\n\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getTopTracks\r\n            function _getTopTracks(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.gettoptracks'\r\n                            // mbid: mbid,\r\n                            // limit: 10,\r\n                            // autocorrect: 1,\r\n                            // page: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTopTracks(artistOrMbid, options){\r\n                return _getTopTracks.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptracks){\r\n                            return reject(response, 'Couldn\\'t find tracks');\r\n                        }\r\n                        return response.data.toptracks.track;\r\n                    });\r\n            }\r\n\r\n\r\n            // Charts\r\n\r\n            // Docs: http://www.last.fm/api/show/chart.getTopArtists\r\n            function _getTopArtists(options){\r\n                var settings = {\r\n                            method: 'chart.gettopartists'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getTopArtists(options){\r\n                return _getTopArtists.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.artists){\r\n                            return reject(response, 'Couldn\\'t find artist');\r\n                        }\r\n                        return response.data.artists.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/chart.getTopTags\r\n            function _getChartsTopTags(options){\r\n                var settings = {\r\n                            method: 'chart.gettoptags'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getChartsTopTags(options){\r\n                return _getChartsTopTags.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.tags){\r\n                            return reject(response, 'Couldn\\'t find tags');\r\n                        }\r\n                        return response.data.tags.tag;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/chart.getTopTracks\r\n            function _getChartsTopTracks(options){\r\n                var settings = {\r\n                            method: 'chart.gettoptracks'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getChartsTopTracks(options){\r\n                return _getChartsTopTracks.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.tracks){\r\n                            return reject(response, 'Couldn\\'t find tracks');\r\n                        }\r\n                        return response.data.tracks.track;\r\n                    });\r\n            }\r\n\r\n\r\n            // Geo\r\n\r\n            // Docs: http://www.last.fm/api/show/geo.getTopArtists\r\n            function _getTopGeoArtists(country, options){\r\n                var settings = {\r\n                            country: country,\r\n                            method: 'geo.gettopartists'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getTopGeoArtists(country, options){\r\n                return _getTopGeoArtists.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.topartists){\r\n                            return reject(response, 'Couldn\\'t find artists');\r\n                        }\r\n                        return response.data.topartists.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/geo.getTopTracks\r\n            function _getTopGeoTracks(country, options){\r\n                var settings = {\r\n                            country: country,\r\n                            method: 'geo.gettoptracks'\r\n                            // limit: 10,\r\n                            // page: 1,\r\n                            // location: 'Manchester'\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getTopGeoTracks(country, options){\r\n                return _getTopGeoTracks.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.tracks){\r\n                            return reject(response, 'Couldn\\'t find tracks');\r\n                        }\r\n                        return response.data.tracks.track;\r\n                    });\r\n            }\r\n\r\n\r\n            // Track\r\n\r\n            // Docs: http://www.last.fm/api/show/track.search\r\n            function _searchTrack(track, options){\r\n                var settings = {\r\n                            track: track,\r\n                            method: 'track.search'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function searchTrack(track, options){\r\n                // console.log(LastFMService.prototype);\r\n                return _searchTrack.apply(LastFMService.prototype, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.results || !response.data.results.trackmatches){\r\n                            return reject(response, 'Couldn\\'t find track');\r\n                        }\r\n                        return response.data.results.trackmatches.track;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/track.getSimilar\r\n            function _getSimilarTrack(artistOrMbid, track, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            track: track,\r\n                            method: 'track.getsimilar'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1,\r\n                            // limit: 10\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getSimilarTrack(artistOrMbid, track, options){\r\n                return _getSimilarTrack.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.similartracks){\r\n                            return reject(response, 'Couldn\\'t find similar tracks');\r\n                        }\r\n                        return response.data.similartracks.track;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/track.getTopTags\r\n            function _getTrackTopTags(artist, track, options){\r\n                var settings = {\r\n                            artist: artist,\r\n                            track: track,\r\n                            method: 'track.gettoptags'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTrackTopTags(artist, track, options){\r\n                return _getTrackTopTags.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptags){\r\n                            return reject(response, 'Couldn\\'t find tags');\r\n                        }\r\n                        return response.data.toptags.tag;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/track.getInfo\r\n            function _getTrackInfo(artistOrMbid, track, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            track: track,\r\n                            method: 'track.getInfo'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTrackInfo(artistOrMbid, track, options){\r\n                return _getTrackInfo.apply(_p, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.track){\r\n                            return reject(response, 'Couldn\\'t find track');\r\n                        }\r\n                        return response.data.track;\r\n                    });\r\n            }\r\n\r\n            function reject(response, reason){\r\n                var error = {\r\n                        error: response.data.error || true,\r\n                        statusText: response.data.message || (reason || 'Error')\r\n                    };\r\n                return $q.reject(error);\r\n            }\r\n\r\n            LastFMService.prototype = {\r\n                getParams :         getParams,\r\n                isMbid :            isMbid,\r\n                Album: {\r\n                    album:          getAlbumInfo,\r\n                    search:         searchAlbum,\r\n                    topTags:        getAlbumTopTags,\r\n                    _album:         _getAlbumInfo,\r\n                    _search:        _searchAlbum,\r\n                    _topTags:       _getAlbumTopTags\r\n                },\r\n                Artist: {\r\n                    albums:         getTopAlbums,\r\n                    artist:         getArtistInfo,\r\n                    search:         searchArtists,\r\n                    similar:        getSimilar,\r\n                    topTags:        getArtistTopTags,\r\n                    tracks:         getTopTracks,\r\n                    _albums:        _getTopAlbums,\r\n                    _artist:        _getArtistInfo,\r\n                    _search:        _searchArtists,\r\n                    _similar:       _getSimilar,\r\n                    _topTags:       _getArtistTopTags,\r\n                    _tracks:        _getTopTracks\r\n                },\r\n                Charts: {\r\n                    topArtists:     getTopArtists,\r\n                    topTags:        getChartsTopTags,\r\n                    topTracks:      getChartsTopTracks,\r\n                    _topArtists:    _getTopArtists,\r\n                    _topTags:       _getChartsTopTags,\r\n                    _topTracks:     _getChartsTopTracks\r\n\r\n                },\r\n                Geo : {\r\n                    topArtists:     getTopGeoArtists,\r\n                    topTracks:      getTopGeoTracks,\r\n                    _topArtists:    _getTopGeoArtists,\r\n                    _topTracks:     _getTopGeoTracks\r\n\r\n                },\r\n                Track: {\r\n                    search:         searchTrack,\r\n                    similar:        getSimilarTrack,\r\n                    topTags:        getTrackTopTags,\r\n                    track:          getTrackInfo,\r\n                    _search:        _searchTrack,\r\n                    _similar:       _getSimilarTrack,\r\n                    _topTags:       _getTrackTopTags,\r\n                    _track:         _getTrackInfo\r\n\r\n                }\r\n            }\r\n\r\n            var _p = LastFMService.prototype;\r\n\r\n            return new LastFMService();\r\n        }\r\n\r\n    }\r\n\r\n}());"],"sourceRoot":"/source/"}