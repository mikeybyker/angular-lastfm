{"version":3,"sources":["angular.lastfm.js"],"names":["LastFM","endPoint","config","api_key","format","this","setAPIKey","key","getAPIKey","setFormat","getFormat","setEndPoint","url","getEndPoint","$get","$q","$http","LastFMService","version","http","settings","options","params","getParams","get","angular","extend","getSettings","fieldName","isMbid","mbid","str","mbidPattern","test","_getAlbumInfo","artistOrMbid","album","artist","method","getAlbumInfo","apply","arguments","then","response","data","error","reject","_getAlbumTopTags","getAlbumTopTags","toptags","tag","_searchAlbum","searchAlbum","results","albummatches","_getArtistInfo","getArtistInfo","_getSimilar","getSimilar","similarartists","_getTopAlbums","getTopAlbums","topalbums","_getArtistTopTags","getArtistTopTags","_getTopTracks","getTopTracks","toptracks","track","_searchArtists","searchArtists","artistmatches","_getTopArtists","getTopArtists","artists","_getChartsTopTags","getChartsTopTags","tags","_getChartsTopTracks","getChartsTopTracks","tracks","_getTopGeoArtists","country","getTopGeoArtists","topartists","_getTopGeoTracks","getTopGeoTracks","_getTrackInfo","getTrackInfo","_getSimilarTrack","getSimilarTrack","similartracks","_getTrackTopTags","getTrackTopTags","_searchTrack","searchTrack","prototype","trackmatches","reason","statusText","message","Album","getInfo","bind","getTopTags","search","_getInfo","_getTopTags","_search","Artist","Charts","Geo","Track","module","provider"],"mappings":"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","file":"angular.lastfm.min.js","sourcesContent":["(function(){\r\n    'use strict';\r\n\r\n    angular\r\n        .module('lastfm', [])\r\n        .provider('LastFM', LastFM);\r\n\r\n    function LastFM(){\r\n\r\n        var endPoint = 'http://ws.audioscrobbler.com/2.0/',\r\n            config = {api_key: null, format: 'json'};\r\n\r\n        this.setAPIKey = function (key) {\r\n            config.api_key = key;\r\n            return config.api_key;\r\n        };\r\n        this.getAPIKey = function () {\r\n            return config.api_key;\r\n        };\r\n        this.setFormat = function (format) {\r\n            config.format = format;\r\n            return config.format;\r\n        };\r\n        this.getFormat = function () {\r\n            return config.format;\r\n        };\r\n        this.setEndPoint = function (url) {\r\n            endPoint = url;\r\n            return endPoint;\r\n        };\r\n        this.getEndPoint = function () {\r\n            return endPoint;\r\n        };\r\n\r\n        this.$get = function($q, $http){\r\n\r\n            // Regex for matching Music Brainz Identifier (mbid)\r\n            var mbidPattern = /^[a-fA-F0-9]{8}(-[a-fA-F0-9]{4}){3}-[a-fA-F0-9]{12}$/;\r\n\r\n            function LastFMService() {\r\n                this.version = '1.0.0';\r\n                if(!config.api_key){\r\n                    throw ('LastFm API key NOT set : Use setAPIKey on the provider in config...');\r\n                }\r\n            }\r\n\r\n            function http(settings, options){\r\n                var params = getParams(settings, options);\r\n                return $http.get(endPoint, {params: params});\r\n            }\r\n\r\n            function getParams(settings, options){\r\n                return  angular.extend(\r\n                            {},             // So we don't pollute the objects\r\n                            config,         // api_key and format\r\n                            settings,       // method etc.\r\n                            options || {}   // user options\r\n                        );\r\n            }\r\n\r\n            function getSettings(settings, fieldName){\r\n                fieldName = fieldName || 'artist';\r\n                if(isMbid(settings[fieldName])){\r\n                    settings.mbid = settings[fieldName];\r\n                    settings[fieldName] = '';\r\n                    // or... mbid takes precedence, regardless\r\n                    // delete settings[fieldName];\r\n                }\r\n                return settings;\r\n            }\r\n\r\n            function isMbid(str){\r\n                return mbidPattern.test(str);\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/album.getInfo\r\n            function _getAlbumInfo(artistOrMbid, album, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            album: album,\r\n                            method: 'album.getinfo'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1,\r\n                            // lang: 'de'\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getAlbumInfo(artistOrMbid, album, options){\r\n                return _getAlbumInfo.apply(this, arguments)\r\n                        .then(function(response){\r\n                            if(response.data.error || !response.data.album){\r\n                                return reject(response, 'Couldn\\'t find this album');\r\n                            }\r\n                            return response.data.album;\r\n                        });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/album.getTopTags\r\n            /*\r\n                Note: Docs say artist & album optional if mbid is used...\r\n                That appers wrong - supplying mbid returns error artist/album missing.\r\n            */\r\n            function _getAlbumTopTags(artistOrMbid, album, options){\r\n                var settings = {\r\n                            method: 'album.gettoptags',\r\n                            album :album,\r\n                            artist :artistOrMbid\r\n                            // mbid :mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getAlbumTopTags(artistOrMbid, album, options){\r\n                return _getAlbumTopTags.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptags){\r\n                            return reject(response, 'Error looking up tags');\r\n                        }\r\n                        return response.data.toptags.tag;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/album.search\r\n            function _searchAlbum(album, options){\r\n                var settings = {\r\n                            album: album,\r\n                            method: 'album.search'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            // Return the actual albums found, rather than end user digging the data for them...\r\n            function searchAlbum(album, options){\r\n                return _searchAlbum.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.results || !response.data.results.albummatches){\r\n                            return reject(response, 'Couldn\\'t find this album');\r\n                        }\r\n                        return response.data.results.albummatches.album;\r\n                    });\r\n            }\r\n\r\n\r\n            // Artist\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getInfo\r\n            function _getArtistInfo(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.getinfo'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1,\r\n                            // lang: 'de'\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getArtistInfo(artistOrMbid, options){\r\n                return _getArtistInfo.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.artist){\r\n                            return reject(response, 'Couldn\\'t find artist');\r\n                        }\r\n                        return response.data.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getSimilar\r\n            function _getSimilar(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.getsimilar'\r\n                            // mbid: mbid,\r\n                            // limit: 10,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getSimilar(artistOrMbid, options){\r\n                return _getSimilar.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.similarartists){\r\n                            return reject(response, 'Couldn\\'t find similar artists');\r\n                        }\r\n                        return response.data.similarartists.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getTopAlbums\r\n            function _getTopAlbums(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.gettopalbums'\r\n                            // mbid: mbid,\r\n                            // limit: 10,\r\n                            // autocorrect: 1,\r\n                            // page: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTopAlbums(artistOrMbid, options){\r\n                return _getTopAlbums.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.topalbums){\r\n                            return reject(response, 'Couldn\\'t find albums');\r\n                        }\r\n                        return response.data.topalbums.album;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getTopTags\r\n            function _getArtistTopTags(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.gettoptags'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getArtistTopTags(artistOrMbid, options){\r\n                return _getArtistTopTags.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptags){\r\n                            return reject(response, 'Couldn\\'t find tags');\r\n                        }\r\n                        return response.data.toptags.tag;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.getTopTracks\r\n            function _getTopTracks(artistOrMbid, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            method: 'artist.gettoptracks'\r\n                            // mbid: mbid,\r\n                            // limit: 10,\r\n                            // autocorrect: 1,\r\n                            // page: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTopTracks(artistOrMbid, options){\r\n                return _getTopTracks.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptracks){\r\n                            return reject(response, 'Couldn\\'t find tracks');\r\n                        }\r\n                        return response.data.toptracks.track;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/artist.search\r\n            function _searchArtists(artist, options) {\r\n                var settings = {\r\n                            artist: artist,\r\n                            method: 'artist.search'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function searchArtists(artist, options) {\r\n                return _searchArtists.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.results || !response.data.results.artistmatches){\r\n                            return reject(response, 'Couldn\\'t find artist');\r\n                        }\r\n                        return response.data.results.artistmatches.artist;\r\n                    });\r\n            }\r\n\r\n\r\n            // Charts\r\n\r\n            // Docs: http://www.last.fm/api/show/chart.getTopArtists\r\n            function _getTopArtists(options){\r\n                var settings = {\r\n                            method: 'chart.gettopartists'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getTopArtists(options){\r\n                return _getTopArtists.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.artists){\r\n                            return reject(response, 'Couldn\\'t find artist');\r\n                        }\r\n                        return response.data.artists.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/chart.getTopTags\r\n            function _getChartsTopTags(options){\r\n                var settings = {\r\n                            method: 'chart.gettoptags'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getChartsTopTags(options){\r\n                return _getChartsTopTags.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.tags){\r\n                            return reject(response, 'Couldn\\'t find tags');\r\n                        }\r\n                        return response.data.tags.tag;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/chart.getTopTracks\r\n            function _getChartsTopTracks(options){\r\n                var settings = {\r\n                            method: 'chart.gettoptracks'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getChartsTopTracks(options){\r\n                return _getChartsTopTracks.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.tracks){\r\n                            return reject(response, 'Couldn\\'t find tracks');\r\n                        }\r\n                        return response.data.tracks.track;\r\n                    });\r\n            }\r\n\r\n\r\n            // Geo\r\n\r\n            // Docs: http://www.last.fm/api/show/geo.getTopArtists\r\n            function _getTopGeoArtists(country, options){\r\n                var settings = {\r\n                            country: country,\r\n                            method: 'geo.gettopartists'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getTopGeoArtists(country, options){\r\n                return _getTopGeoArtists.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.topartists){\r\n                            return reject(response, 'Couldn\\'t find artists');\r\n                        }\r\n                        return response.data.topartists.artist;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/geo.getTopTracks\r\n            function _getTopGeoTracks(country, options){\r\n                var settings = {\r\n                            country: country,\r\n                            method: 'geo.gettoptracks'\r\n                            // limit: 10,\r\n                            // page: 1,\r\n                            // location: 'Manchester'\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function getTopGeoTracks(country, options){\r\n                return _getTopGeoTracks.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.tracks){\r\n                            return reject(response, 'Couldn\\'t find tracks');\r\n                        }\r\n                        return response.data.tracks.track;\r\n                    });\r\n            }\r\n\r\n\r\n            // Track\r\n\r\n            // Docs: http://www.last.fm/api/show/track.getInfo\r\n            function _getTrackInfo(artistOrMbid, track, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            track: track,\r\n                            method: 'track.getInfo'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTrackInfo(artistOrMbid, track, options){\r\n                return _getTrackInfo.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.track){\r\n                            return reject(response, 'Couldn\\'t find track');\r\n                        }\r\n                        return response.data.track;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/track.getSimilar\r\n            function _getSimilarTrack(artistOrMbid, track, options){\r\n                var settings = {\r\n                            artist: artistOrMbid,\r\n                            track: track,\r\n                            method: 'track.getsimilar'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1,\r\n                            // limit: 10\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getSimilarTrack(artistOrMbid, track, options){\r\n                return _getSimilarTrack.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.similartracks){\r\n                            return reject(response, 'Couldn\\'t find similar tracks');\r\n                        }\r\n                        return response.data.similartracks.track;\r\n                    });\r\n            }\r\n//@todo artist > artistOrMbid\r\n            // Docs: http://www.last.fm/api/show/track.getTopTags\r\n            function _getTrackTopTags(artist, track, options){\r\n                var settings = {\r\n                            artist: artist,\r\n                            track: track,\r\n                            method: 'track.gettoptags'\r\n                            // mbid: mbid,\r\n                            // autocorrect: 1\r\n                    };\r\n                settings = getSettings(settings);\r\n                return http(settings, options);\r\n            }\r\n            function getTrackTopTags(artist, track, options){\r\n                return _getTrackTopTags.apply(this, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.toptags){\r\n                            return reject(response, 'Couldn\\'t find tags');\r\n                        }\r\n                        return response.data.toptags.tag;\r\n                    });\r\n            }\r\n\r\n            // Docs: http://www.last.fm/api/show/track.search\r\n            function _searchTrack(track, options){\r\n                var settings = {\r\n                            track: track,\r\n                            method: 'track.search'\r\n                            // limit: 10,\r\n                            // page: 1\r\n                    };\r\n                return http(settings, options);\r\n            }\r\n            function searchTrack(track, options){\r\n                // console.log(LastFMService.prototype);\r\n                return _searchTrack.apply(LastFMService.prototype, arguments)\r\n                    .then(function(response){\r\n                        if(response.data.error || !response.data.results || !response.data.results.trackmatches){\r\n                            return reject(response, 'Couldn\\'t find track');\r\n                        }\r\n                        return response.data.results.trackmatches.track;\r\n                    });\r\n            }\r\n\r\n\r\n            function reject(response, reason){\r\n                var error = {\r\n                        error: response.data.error || true,\r\n                        statusText: response.data.message || (reason || 'Error')\r\n                    };\r\n                return $q.reject(error);\r\n            }\r\n\r\n            LastFMService.prototype = {\r\n                getParams :         getParams,\r\n                isMbid :            isMbid,\r\n                Album: {\r\n                    getInfo:        getAlbumInfo.bind(this),\r\n                    getTopTags:     getAlbumTopTags.bind(this),\r\n                    search:         searchAlbum.bind(this),\r\n                    _getInfo:       _getAlbumInfo.bind(this),\r\n                    _getTopTags:    _getAlbumTopTags.bind(this),\r\n                    _search:        _searchAlbum.bind(this)\r\n                },\r\n                Artist: {\r\n                    getInfo:        getArtistInfo.bind(this),\r\n                    getSimilar:     getSimilar.bind(this),\r\n                    getTopAlbums:   getTopAlbums.bind(this),\r\n                    getTopTags:     getArtistTopTags.bind(this),\r\n                    getTopTracks:   getTopTracks.bind(this),                    \r\n                    search:         searchArtists.bind(this),\r\n                    _getInfo:       _getArtistInfo.bind(this),\r\n                    _getSimilar:    _getSimilar.bind(this),\r\n                    _getTopAlbums:  _getTopAlbums.bind(this),\r\n                    _getTopTags:    _getArtistTopTags.bind(this),\r\n                    _getTopTracks:  _getTopTracks.bind(this),\r\n                    _search:        _searchArtists.bind(this)\r\n                },\r\n                Charts: {                    \r\n                    getTopArtists:  getTopArtists.bind(this),\r\n                    getTopTags:     getChartsTopTags.bind(this),\r\n                    getTopTracks:   getChartsTopTracks.bind(this),                    \r\n                    _getTopArtists: _getTopArtists.bind(this),\r\n                    _getTopTags:    _getChartsTopTags.bind(this),\r\n                    _getTopTracks:  _getChartsTopTracks.bind(this)\r\n                },\r\n                Geo : {\r\n                     getTopArtists:  getTopGeoArtists.bind(this),\r\n                     getTopTracks:   getTopGeoTracks.bind(this),                   \r\n                    _getTopArtists: _getTopGeoArtists.bind(this),\r\n                    _getTopTracks:  _getTopGeoTracks.bind(this)\r\n                },\r\n                Track: {                    \r\n                    getInfo:        getTrackInfo.bind(this),\r\n                    getSimilar:     getSimilarTrack.bind(this),\r\n                    getTopTags:     getTrackTopTags.bind(this),\r\n                    search:         searchTrack.bind(this),\r\n                    _getInfo:       _getTrackInfo.bind(this),\r\n                    _getSimilar:    _getSimilarTrack.bind(this),\r\n                    _getTopTags:    _getTrackTopTags.bind(this),\r\n                    _search:        _searchTrack.bind(this)\r\n                }\r\n            }\r\n\r\n            var _p = LastFMService.prototype;\r\n\r\n            return new LastFMService();\r\n        }\r\n\r\n    }\r\n\r\n}());"],"sourceRoot":"/source/"}